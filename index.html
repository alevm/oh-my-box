<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="screen-orientation" content="landscape">
    <title>Oh My Box</title>
    <link rel="stylesheet" href="css/style.css?v=129">
</head>
<body>
    <!-- Full-page map background -->
    <div id="mapBackground" class="map-bg"></div>

    <div id="app">
        <!-- Top Bar: Transport + Info -->
        <header class="top-bar">
            <div class="logo">OH MY BOX</div>
            <div class="transport">
                <button id="btnPlay" class="tr-btn play">‚ñ∂</button>
                <button id="btnStop" class="tr-btn stop">‚ñ†</button>
                <button id="btnRecord" class="tr-btn rec">‚óè</button>
            </div>
            <div class="tempo-box">
                <input type="range" id="tempoSlider" min="60" max="200" value="120">
                <span id="tempoVal">120</span>
                <button id="btnTap" class="tap-btn">TAP</button>
            </div>
            <button id="btnHelp" class="help-btn" title="Keyboard Shortcuts">?</button>
            <div class="gps-box" id="gpsBox">
                <span class="gps-icon">‚óé</span>
                <span id="gpsText">--</span>
            </div>
            <div class="time-box" id="timeDisplay">00:00</div>
            <button id="btnAdmin" class="admin-btn" title="Settings">‚öô</button>
            <div class="version">v1.5.0</div>
        </header>

        <!-- Main Device Area - 12 Equal Tiles (4x3) -->
        <main class="device">
            <!-- Row 1: SEQ | MIXER | SYNTH | SCENES -->
            <div class="panel seq-panel">
                <div class="seq-header">
                    <span class="panel-title">SEQ</span>
                    <div class="seq-controls">
                        <div class="src-btns">
                            <button class="src-btn active" data-src="sampler">SMP</button>
                            <button class="src-btn" data-src="synth">SYN</button>
                            <button class="src-btn" data-src="radio">RAD</button>
                            <button class="src-btn" data-src="mic">MIC</button>
                        </div>
                        <button id="seqRandom" class="seq-btn mini">RND</button>
                        <button id="seqClear" class="seq-btn mini">CLR</button>
                        <button id="eucGen" class="seq-btn mini">EUC</button>
                        <button id="dubToggle" class="seq-btn mini dub-btn">DUB</button>
                        <button id="fillBtn" class="seq-btn mini fill-btn">FILL</button>
                    </div>
                </div>
                <div class="oct-tracks" id="octTracks"></div>
                <div id="plockEditor" class="plock-editor hidden">
                    <div class="plock-header"><span class="plock-title">STEP <span id="plockStepNum">1</span></span><button id="plockClose" class="plock-close">√ó</button></div>
                    <div class="plock-params">
                        <div class="plock-row"><span>PITCH</span><input type="range" id="plockPitch" min="-24" max="24" value="0"><span id="plockPitchVal">0</span></div>
                        <div class="plock-row"><span>SLICE</span><input type="range" id="plockSlice" min="0" max="15" value="0"><span id="plockSliceVal">0</span></div>
                        <div class="plock-row"><span>FILT</span><input type="range" id="plockFilter" min="0" max="100" value="50"><span id="plockFilterVal">50</span></div>
                        <div class="plock-row"><span>DECAY</span><input type="range" id="plockDecay" min="0" max="100" value="50"><span id="plockDecayVal">50</span></div>
                    </div>
                    <div class="trig-cond">
                        <span>TRIG</span>
                        <div class="trig-btns" id="trigCondBtns">
                            <button class="trig-btn active" data-cond="always">ALL</button>
                            <button class="trig-btn" data-cond="probability">PROB</button>
                            <button class="trig-btn" data-cond="fill">FILL</button>
                            <button class="trig-btn" data-cond="notFill">!FILL</button>
                            <button class="trig-btn" data-cond="nth">NTH</button>
                            <button class="trig-btn" data-cond="neighbor">NEIGH</button>
                        </div>
                        <input type="number" id="trigCondValue" min="1" max="100" value="100">
                    </div>
                </div>
            </div>
            <div class="panel mixer-panel">
                <div class="panel-title">MIXER</div>
                <div class="mixer-channels">
                    <div class="ch"><span class="ch-name">MIC</span><div class="vu-meter"><div class="vu-fill" id="vuMic"></div></div><input type="range" class="v-fader" id="faderMic" min="0" max="100" value="80" orient="vertical"><button class="mute" id="muteMic">M</button></div>
                    <div class="ch"><span class="ch-name">SMP</span><div class="vu-meter"><div class="vu-fill" id="vuSamples"></div></div><input type="range" class="v-fader" id="faderSamples" min="0" max="100" value="80" orient="vertical"><button class="mute" id="muteSamples">M</button></div>
                    <div class="ch"><span class="ch-name">SYN</span><div class="vu-meter"><div class="vu-fill" id="vuSynth"></div></div><input type="range" class="v-fader" id="faderSynth" min="0" max="100" value="80" orient="vertical"><button class="mute" id="muteSynth">M</button></div>
                    <div class="ch"><span class="ch-name">RAD</span><div class="vu-meter"><div class="vu-fill" id="vuRadio"></div></div><input type="range" class="v-fader" id="faderRadio" min="0" max="100" value="80" orient="vertical"><button class="mute" id="muteRadio">M</button></div>
                    <div class="ch master"><span class="ch-name">OUT</span><div class="vu-meter"><div class="vu-fill" id="vuMaster"></div></div><input type="range" class="v-fader" id="faderMaster" min="0" max="100" value="90" orient="vertical"></div>
                </div>
            </div>
            <div class="panel synth-panel">
                <div class="synth-header"><span class="panel-title">SYNTH</span><button id="synthToggle" class="power-btn">OFF</button></div>
                <div class="wave-btns">
                    <button class="wave-btn active" data-wave="sine">SIN</button>
                    <button class="wave-btn" data-wave="triangle">TRI</button>
                    <button class="wave-btn" data-wave="sawtooth">SAW</button>
                    <button class="wave-btn" data-wave="square">SQR</button>
                </div>
                <div class="adsr-row">
                    <div class="adsr-param"><span>A</span><input type="range" id="adsrAttack" min="0" max="1000" value="10"><span id="adsrAVal">10</span></div>
                    <div class="adsr-param"><span>D</span><input type="range" id="adsrDecay" min="0" max="1000" value="100"><span id="adsrDVal">100</span></div>
                    <div class="adsr-param"><span>S</span><input type="range" id="adsrSustain" min="0" max="100" value="70"><span id="adsrSVal">70</span></div>
                    <div class="adsr-param"><span>R</span><input type="range" id="adsrRelease" min="0" max="2000" value="200"><span id="adsrRVal">200</span></div>
                </div>
            </div>
            <div class="panel scenes-panel">
                <div class="panel-title">SCENES</div>
                <div class="scene-row">
                    <button class="scene-btn active" data-scene="0">A</button>
                    <button class="scene-btn" data-scene="1">B</button>
                    <button class="scene-btn" data-scene="2">C</button>
                    <button class="scene-btn" data-scene="3">D</button>
                </div>
                <div class="xfade-row"><span id="xfadeLeft">A</span><input type="range" id="sceneCrossfader" class="xfader" min="0" max="100" value="0"><span id="xfadeRight">B</span></div>
                <div class="scene-actions"><button id="saveScene">SAVE</button><button id="loadScene">LOAD</button></div>
            </div>
            <div class="panel ai-panel">
                <div class="panel-title">AI GEN</div>
                <div class="vibe-btns">
                    <button class="vibe-btn active" data-vibe="calm">C</button>
                    <button class="vibe-btn" data-vibe="urban">U</button>
                    <button class="vibe-btn" data-vibe="nature">N</button>
                    <button class="vibe-btn" data-vibe="chaos">X</button>
                </div>
                <button id="aiGenerate" class="ai-btn">GENERATE</button>
            </div>

            <!-- Row 2: PADS | PADS2 | CTRL | FX -->
            <div class="panel pads-panel">
                <div class="pads-header">
                    <span class="panel-title">PADS A</span>
                    <div class="kit-btns">
                        <button class="kit-btn active" data-kit="kit1">1</button>
                        <button class="kit-btn" data-kit="kit2">2</button>
                        <button class="kit-btn" data-kit="kit3">3</button>
                    </div>
                </div>
                <div class="pads-grid">
                    <button class="pad" data-pad="0">1</button>
                    <button class="pad" data-pad="1">2</button>
                    <button class="pad" data-pad="2">3</button>
                    <button class="pad" data-pad="3">4</button>
                    <button class="pad" data-pad="4">5</button>
                    <button class="pad" data-pad="5">6</button>
                    <button class="pad" data-pad="6">7</button>
                    <button class="pad" data-pad="7">8</button>
                </div>
            </div>
            <div class="panel pads-panel pads2">
                <div class="pads-header">
                    <span class="panel-title">PADS B</span>
                    <select id="sampleBank2"><option value="kit1">Kit1</option><option value="kit2">Kit2</option><option value="kit3">Kit3</option></select>
                </div>
                <div class="pads-grid">
                    <button class="pad" data-pad="8">9</button>
                    <button class="pad" data-pad="9">10</button>
                    <button class="pad" data-pad="10">11</button>
                    <button class="pad" data-pad="11">12</button>
                    <button class="pad" data-pad="12">13</button>
                    <button class="pad" data-pad="13">14</button>
                    <button class="pad" data-pad="14">15</button>
                    <button class="pad" data-pad="15">16</button>
                </div>
            </div>
            <div class="panel knobs-panel">
                <div class="ctrl-header">
                    <span class="panel-title">CTRL</span>
                    <div class="target-btns">
                        <button class="target-btn active" data-target="fx">FX</button>
                        <button class="target-btn" data-target="synth">SYN</button>
                        <button class="target-btn" data-target="sampler">SMP</button>
                    </div>
                </div>
                <div class="knobs-grid">
                    <div class="knob-group"><div class="knob" id="knobFreq" data-param="freq" data-min="20" data-max="2000" data-value="220"></div><span>FREQ</span></div>
                    <div class="knob-group"><div class="knob" id="knobFilter" data-param="filter" data-min="20" data-max="8000" data-value="4000"></div><span>FILT</span></div>
                    <div class="knob-group"><div class="knob" id="knobDelay" data-param="delay" data-min="0" data-max="100" data-value="0"></div><span>DLY</span></div>
                    <div class="knob-group"><div class="knob" id="knobGrain" data-param="grain" data-min="0" data-max="100" data-value="0"></div><span>GRN</span></div>
                    <div class="knob-group"><div class="knob" id="knobReso" data-param="reso" data-min="0" data-max="100" data-value="0"></div><span>RES</span></div>
                    <div class="knob-group"><div class="knob" id="knobDrive" data-param="drive" data-min="0" data-max="100" data-value="0"></div><span>DRV</span></div>
                </div>
            </div>
            <div class="panel fx-panel">
                <div class="fx-header">
                    <span class="panel-title">FX</span>
                    <div class="fx-preset-btns" id="fxPresetBtns">
                        <button class="fx-preset-btn active" data-preset="0">--</button>
                    </div>
                    <button id="saveFx">+</button>
                </div>
                <div class="fx-params">
                    <div class="fx-row"><span>DLY</span><input type="range" id="fxDelay" min="0" max="100" value="0"></div>
                    <div class="fx-row"><span>GRN</span><input type="range" id="fxGrain" min="0" max="100" value="0"></div>
                    <div class="fx-row"><span>GLI</span><input type="range" id="fxGlitch" min="0" max="100" value="0"></div>
                    <div class="fx-row"><span>CRU</span><input type="range" id="fxCrush" min="1" max="16" value="16"></div>
                </div>
                <div class="punch-fx">
                    <button class="punch-btn" data-fx="stutter">STT</button>
                    <button class="punch-btn" data-fx="reverse">REV</button>
                    <button class="punch-btn" data-fx="filter">FLT</button>
                    <button class="punch-btn" data-fx="tape">TPE</button>
                </div>
            </div>

            <!-- Row 3: RADIO | LOCATION | AI GEN | REC -->
            <div class="panel radio-panel">
                <div class="panel-title">RADIO</div>
                <div class="radio-dial">
                    <div class="freq-display" id="radioFreq">88.0 FM</div>
                    <div class="knob" id="radioTuner" data-param="tune" data-min="88" data-max="108" data-value="88"></div>
                </div>
                <div class="radio-controls">
                    <button id="radioScan" class="radio-btn">SCAN</button>
                    <button id="radioGo" class="radio-btn">‚ñ∂</button>
                    <button id="radioStop" class="radio-btn" disabled>‚ñ†</button>
                </div>
                <div class="station-list" id="stationList"></div>
            </div>
            <div class="panel map-panel">
                <div class="panel-title">LOCATION</div>
                <div class="map-box" id="miniMap"><div class="map-img" id="miniMapImg"></div></div>
                <div class="map-coords" id="miniMapCoords">--</div>
            </div>
            <div class="panel eq-panel">
                <div class="eq-header">
                    <span class="panel-title">EQ</span>
                    <div class="ch-btns">
                        <button class="ch-btn active" data-ch="master">OUT</button>
                        <button class="ch-btn" data-ch="mic">MIC</button>
                        <button class="ch-btn" data-ch="samples">SMP</button>
                        <button class="ch-btn" data-ch="synth">SYN</button>
                        <button class="ch-btn" data-ch="radio">RAD</button>
                    </div>
                </div>
                <div class="eq-sliders">
                    <div class="eq-band"><span>LO</span><input type="range" class="eq-slider" id="eqLow" min="-12" max="12" value="0" orient="vertical"><span id="eqLowVal">0</span></div>
                    <div class="eq-band"><span>MID</span><input type="range" class="eq-slider" id="eqMid" min="-12" max="12" value="0" orient="vertical"><span id="eqMidVal">0</span></div>
                    <div class="eq-band"><span>HI</span><input type="range" class="eq-slider" id="eqHigh" min="-12" max="12" value="0" orient="vertical"><span id="eqHighVal">0</span></div>
                </div>
            </div>
            <div class="panel rec-panel">
                <div class="rec-header">
                    <span class="panel-title">REC</span>
                    <span id="recCount">0</span>
                </div>
                <div class="rec-last" id="recLast">
                    <span class="rec-map-icon">üìç</span>
                    <span class="rec-last-name">No recordings</span>
                    <span class="rec-last-time">--:--</span>
                </div>
                <div class="rec-actions">
                    <button id="recListBtn" class="rec-list-btn">LIST</button>
                    <button id="aiGenerate" class="ai-btn">AI GEN</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Help Modal (Keyboard Shortcuts) -->
    <div id="helpModal" class="modal help-modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">KEYBOARD SHORTCUTS</span>
                <button id="closeHelp" class="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <div class="help-section">
                    <div class="help-section-title">Transport</div>
                    <div class="shortcut-row"><span class="shortcut-key">SPACE</span><span class="shortcut-desc">Play / Pause</span></div>
                    <div class="shortcut-row"><span class="shortcut-key">R</span><span class="shortcut-desc">Record</span></div>
                    <div class="shortcut-row"><span class="shortcut-key">ESC</span><span class="shortcut-desc">Stop All</span></div>
                </div>
                <div class="help-section">
                    <div class="help-section-title">Pads</div>
                    <div class="shortcut-row"><span class="shortcut-key">1-8</span><span class="shortcut-desc">Trigger Pads 1-8</span></div>
                </div>
                <div class="help-section">
                    <div class="help-section-title">Sequencer</div>
                    <div class="shortcut-row"><span class="shortcut-key">‚Üë/‚Üì</span><span class="shortcut-desc">Select Track</span></div>
                    <div class="shortcut-row"><span class="shortcut-key">SHIFT+Click</span><span class="shortcut-desc">Edit P-Locks</span></div>
                    <div class="shortcut-row"><span class="shortcut-key">D</span><span class="shortcut-desc">Toggle Dub Mode</span></div>
                    <div class="shortcut-row"><span class="shortcut-key">F</span><span class="shortcut-desc">Hold for Fill</span></div>
                </div>
                <div class="help-section">
                    <div class="help-section-title">FX</div>
                    <div class="shortcut-row"><span class="shortcut-key">Q</span><span class="shortcut-desc">Punch Stutter</span></div>
                    <div class="shortcut-row"><span class="shortcut-key">W</span><span class="shortcut-desc">Punch Reverse</span></div>
                    <div class="shortcut-row"><span class="shortcut-key">E</span><span class="shortcut-desc">Punch Filter</span></div>
                    <div class="shortcut-row"><span class="shortcut-key">T</span><span class="shortcut-desc">Punch Tape</span></div>
                </div>
                <div class="help-section">
                    <div class="help-section-title">Other</div>
                    <div class="shortcut-row"><span class="shortcut-key">?</span><span class="shortcut-desc">Show This Help</span></div>
                    <div class="shortcut-row"><span class="shortcut-key">G</span><span class="shortcut-desc">Generate AI Pattern</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Settings Modal -->
    <div id="adminModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">SETTINGS</span>
                <button id="closeAdmin" class="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <div class="settings-title">SAMPLE KITS</div>
                    <div class="kit-list" id="kitList">
                        <div class="kit-item active" data-kit="kit1">Kit 1 (Default)</div>
                        <div class="kit-item" data-kit="kit2">Kit 2 (Electronic)</div>
                        <div class="kit-item" data-kit="kit3">Kit 3 (Acoustic)</div>
                    </div>
                    <input type="file" id="uploadKit" accept="audio/*" multiple hidden>
                    <button id="uploadKitBtn" class="settings-btn">Upload Kit</button>
                </div>
                <div class="settings-section">
                    <div class="settings-title">SYNTH PRESETS</div>
                    <div class="synth-presets" id="synthPresets">
                        <div class="preset-item active" data-preset="default">Default</div>
                        <div class="preset-item" data-preset="bass">Bass</div>
                        <div class="preset-item" data-preset="lead">Lead</div>
                        <div class="preset-item" data-preset="pad">Pad</div>
                    </div>
                </div>
                <div class="settings-section">
                    <div class="settings-title">THEME</div>
                    <div class="theme-options">
                        <button class="theme-btn active" data-theme="mariani">Vin Mariani</button>
                        <button class="theme-btn" data-theme="map">Location Map</button>
                        <button class="theme-btn" data-theme="dark">Dark</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/gps.js"></script>
    <script src="js/audio-engine.js"></script>
    <script src="js/mic-input.js"></script>
    <script src="js/sampler.js"></script>
    <script src="js/synth.js"></script>
    <script src="js/radio.js"></script>
    <script src="js/recorder.js"></script>
    <script src="js/sequencer.js"></script>
    <script src="js/mangle.js"></script>
    <script src="js/scenes.js"></script>
    <script src="js/arrangement.js"></script>
    <script src="js/ai-composer.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
