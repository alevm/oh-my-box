<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="screen-orientation" content="landscape">
    <title>Oh My Box</title>
    <link rel="stylesheet" href="css/style.css?v=102">
</head>
<body>
    <!-- Full-page map background -->
    <div id="mapBackground" class="map-bg"></div>

    <div id="app">
        <!-- Top Bar: Transport + Info -->
        <header class="top-bar">
            <div class="logo">OH MY BOX</div>
            <div class="transport">
                <button id="btnPlay" class="tr-btn play">▶</button>
                <button id="btnStop" class="tr-btn stop">■</button>
                <button id="btnRecord" class="tr-btn rec">●</button>
            </div>
            <div class="tempo-box">
                <input type="range" id="tempoSlider" min="60" max="200" value="120">
                <span id="tempoVal">120</span>
            </div>
            <div class="gps-box" id="gpsBox">
                <span class="gps-icon">◎</span>
                <span id="gpsText">--</span>
            </div>
            <div class="time-box" id="timeDisplay">00:00</div>
            <button id="btnAdmin" class="admin-btn" title="Settings">⚙</button>
            <div class="version">v1.0.2</div>
        </header>

        <!-- Main Device Area - Grid Layout -->
        <main class="device">

            <!-- COL 1: Mixer (full height) -->
            <section class="col col-mixer">
                <div class="panel mixer-panel">
                    <div class="panel-title">MIXER</div>
                    <div class="mixer-channels">
                        <div class="ch">
                            <span class="ch-name">MIC</span>
                            <input type="range" class="v-fader" id="faderMic" min="0" max="100" value="80" orient="vertical">
                            <button class="mute" id="muteMic">M</button>
                        </div>
                        <div class="ch">
                            <span class="ch-name">SMP</span>
                            <input type="range" class="v-fader" id="faderSamples" min="0" max="100" value="80" orient="vertical">
                            <button class="mute" id="muteSamples">M</button>
                        </div>
                        <div class="ch">
                            <span class="ch-name">SYN</span>
                            <input type="range" class="v-fader" id="faderSynth" min="0" max="100" value="80" orient="vertical">
                            <button class="mute" id="muteSynth">M</button>
                        </div>
                        <div class="ch">
                            <span class="ch-name">RAD</span>
                            <input type="range" class="v-fader" id="faderRadio" min="0" max="100" value="80" orient="vertical">
                            <button class="mute" id="muteRadio">M</button>
                        </div>
                        <div class="ch master">
                            <span class="ch-name">OUT</span>
                            <input type="range" class="v-fader" id="faderMaster" min="0" max="100" value="90" orient="vertical">
                        </div>
                    </div>
                </div>
            </section>

            <!-- COL 2: Sequencer only -->
            <section class="col col-seq">
                <div class="panel seq-panel">
                    <div class="seq-header">
                        <span class="panel-title">SEQ</span>
                        <div class="seq-controls">
                            <select id="seqSource">
                                <option value="sampler">SMP</option>
                                <option value="synth">SYN</option>
                                <option value="radio">RAD</option>
                                <option value="mic">MIC</option>
                            </select>
                            <button id="seqRandom" class="seq-btn mini">RND</button>
                            <button id="seqClear" class="seq-btn mini">CLR</button>
                            <button id="eucGen" class="seq-btn mini">EUC</button>
                            <button id="dubToggle" class="seq-btn mini dub-btn">DUB</button>
                            <button id="fillBtn" class="seq-btn mini fill-btn">FILL</button>
                        </div>
                    </div>
                    <div class="oct-tracks" id="octTracks"></div>
                    <!-- P-Lock Editor -->
                    <div id="plockEditor" class="plock-editor hidden">
                        <div class="plock-header">
                            <span class="plock-title">STEP <span id="plockStepNum">1</span></span>
                            <button id="plockClose" class="plock-close">×</button>
                        </div>
                        <div class="plock-params">
                            <div class="plock-row"><span>PITCH</span><input type="range" id="plockPitch" min="-24" max="24" value="0"><span id="plockPitchVal">0</span></div>
                            <div class="plock-row"><span>SLICE</span><input type="range" id="plockSlice" min="0" max="15" value="0"><span id="plockSliceVal">0</span></div>
                            <div class="plock-row"><span>FILT</span><input type="range" id="plockFilter" min="0" max="100" value="50"><span id="plockFilterVal">50</span></div>
                            <div class="plock-row"><span>DECAY</span><input type="range" id="plockDecay" min="0" max="100" value="50"><span id="plockDecayVal">50</span></div>
                        </div>
                        <div class="trig-cond">
                            <span>TRIG</span>
                            <select id="trigCondType">
                                <option value="always">ALWAYS</option>
                                <option value="probability">PROB %</option>
                                <option value="fill">FILL</option>
                                <option value="notFill">!FILL</option>
                                <option value="nth">NTH</option>
                                <option value="neighbor">NEIGH</option>
                            </select>
                            <input type="number" id="trigCondValue" min="1" max="100" value="100">
                        </div>
                    </div>
                </div>

                <!-- Equalizer -->
                <div class="panel eq-panel">
                    <div class="eq-header">
                        <span class="panel-title">EQ</span>
                        <select id="eqChannel">
                            <option value="master">OUT</option>
                            <option value="mic">MIC</option>
                            <option value="samples">SMP</option>
                            <option value="synth">SYN</option>
                            <option value="radio">RAD</option>
                        </select>
                    </div>
                    <div class="eq-sliders">
                        <div class="eq-band"><span>LO</span><input type="range" class="eq-slider" id="eqLow" min="-12" max="12" value="0" orient="vertical"><span id="eqLowVal">0</span></div>
                        <div class="eq-band"><span>MID</span><input type="range" class="eq-slider" id="eqMid" min="-12" max="12" value="0" orient="vertical"><span id="eqMidVal">0</span></div>
                        <div class="eq-band"><span>HI</span><input type="range" class="eq-slider" id="eqHigh" min="-12" max="12" value="0" orient="vertical"><span id="eqHighVal">0</span></div>
                    </div>
                </div>
            </section>

            <!-- COL 3: Knobs + Map + AI + Radio -->
            <section class="col col-mid">
                <!-- Knobs Box -->
                <div class="panel knobs-panel">
                    <div class="panel-title">CTRL</div>
                    <div class="knobs-grid">
                        <div class="knob-group">
                            <div class="knob" id="knobFreq" data-param="freq" data-min="20" data-max="2000" data-value="220"></div>
                            <span>FREQ</span>
                        </div>
                        <div class="knob-group">
                            <div class="knob" id="knobFilter" data-param="filter" data-min="20" data-max="8000" data-value="4000"></div>
                            <span>FILT</span>
                        </div>
                        <div class="knob-group">
                            <div class="knob" id="knobDelay" data-param="delay" data-min="0" data-max="100" data-value="0"></div>
                            <span>DLY</span>
                        </div>
                        <div class="knob-group">
                            <div class="knob" id="knobGrain" data-param="grain" data-min="0" data-max="100" data-value="0"></div>
                            <span>GRN</span>
                        </div>
                    </div>
                </div>

                <!-- Map Box -->
                <div class="panel map-panel">
                    <div class="panel-title">LOCATION</div>
                    <div class="map-box" id="miniMap">
                        <div class="map-img" id="miniMapImg"></div>
                    </div>
                    <div class="map-coords" id="miniMapCoords">--</div>
                </div>

                <!-- AI Generate -->
                <div class="panel ai-panel">
                    <div class="panel-title">AI GEN</div>
                    <div class="vibe-btns">
                        <button class="vibe-btn active" data-vibe="calm">C</button>
                        <button class="vibe-btn" data-vibe="urban">U</button>
                        <button class="vibe-btn" data-vibe="nature">N</button>
                        <button class="vibe-btn" data-vibe="chaos">X</button>
                    </div>
                    <button id="aiGenerate" class="ai-btn">GENERATE</button>
                </div>

                <!-- Radio -->
                <div class="panel radio-panel">
                    <div class="panel-title">RADIO</div>
                    <div class="radio-row">
                        <input type="text" id="radioSearch" placeholder="Search...">
                        <button id="radioGo">▶</button>
                        <button id="radioStop" disabled>■</button>
                    </div>
                    <div class="station-list" id="stationList"></div>
                </div>
            </section>

            <!-- COL 4: Synth + Scenes + FX -->
            <section class="col col-right">
                <!-- Synth Matrix -->
                <div class="panel synth-panel">
                    <div class="synth-header">
                        <span class="panel-title">SYNTH</span>
                        <button id="synthToggle" class="power-btn">OFF</button>
                    </div>
                    <div class="synth-matrix">
                        <div class="matrix-header">
                            <span></span><span>OSC</span><span>NSE</span><span>FLT</span><span>OUT</span>
                        </div>
                        <div class="matrix-row" data-source="osc">
                            <span>OSC</span>
                            <div class="matrix-cell" data-src="osc" data-dst="osc"></div>
                            <div class="matrix-cell" data-src="osc" data-dst="noise"></div>
                            <div class="matrix-cell active" data-src="osc" data-dst="filter"></div>
                            <div class="matrix-cell" data-src="osc" data-dst="out"></div>
                        </div>
                        <div class="matrix-row" data-source="noise">
                            <span>NSE</span>
                            <div class="matrix-cell" data-src="noise" data-dst="osc"></div>
                            <div class="matrix-cell" data-src="noise" data-dst="noise"></div>
                            <div class="matrix-cell" data-src="noise" data-dst="filter"></div>
                            <div class="matrix-cell" data-src="noise" data-dst="out"></div>
                        </div>
                        <div class="matrix-row" data-source="filter">
                            <span>FLT</span>
                            <div class="matrix-cell" data-src="filter" data-dst="osc"></div>
                            <div class="matrix-cell" data-src="filter" data-dst="noise"></div>
                            <div class="matrix-cell" data-src="filter" data-dst="filter"></div>
                            <div class="matrix-cell active" data-src="filter" data-dst="out"></div>
                        </div>
                    </div>
                    <div class="wave-btns">
                        <button class="wave-btn active" data-wave="sine">SIN</button>
                        <button class="wave-btn" data-wave="triangle">TRI</button>
                        <button class="wave-btn" data-wave="sawtooth">SAW</button>
                        <button class="wave-btn" data-wave="square">SQR</button>
                    </div>
                    <div class="adsr-row">
                        <div class="adsr-param"><span>A</span><input type="range" id="adsrAttack" min="0" max="1000" value="10"><span id="adsrAVal">10</span></div>
                        <div class="adsr-param"><span>D</span><input type="range" id="adsrDecay" min="0" max="1000" value="100"><span id="adsrDVal">100</span></div>
                        <div class="adsr-param"><span>S</span><input type="range" id="adsrSustain" min="0" max="100" value="70"><span id="adsrSVal">70</span></div>
                        <div class="adsr-param"><span>R</span><input type="range" id="adsrRelease" min="0" max="2000" value="200"><span id="adsrRVal">200</span></div>
                    </div>
                </div>

                <!-- Scenes -->
                <div class="panel scenes-panel">
                    <div class="panel-title">SCENES</div>
                    <div class="scene-row">
                        <button class="scene-btn active" data-scene="0">A</button>
                        <button class="scene-btn" data-scene="1">B</button>
                        <button class="scene-btn" data-scene="2">C</button>
                        <button class="scene-btn" data-scene="3">D</button>
                    </div>
                    <div class="xfade-row">
                        <span id="xfadeLeft">A</span>
                        <input type="range" id="sceneCrossfader" class="xfader" min="0" max="100" value="0">
                        <span id="xfadeRight">B</span>
                    </div>
                    <div class="scene-actions">
                        <button id="saveScene">SAVE</button>
                        <select id="sceneScope">
                            <option value="all">ALL</option>
                            <option value="mixer">MIX</option>
                            <option value="seq">SEQ</option>
                            <option value="fx">FX</option>
                        </select>
                    </div>
                </div>

                <!-- FX -->
                <div class="panel fx-panel">
                    <div class="fx-header">
                        <span class="panel-title">FX</span>
                        <select id="fxPreset">
                            <option value="0">--</option>
                            <option value="1">FX1</option>
                            <option value="2">FX2</option>
                        </select>
                        <button id="saveFx">+</button>
                    </div>
                    <div class="fx-params">
                        <div class="fx-row"><span>DLY</span><input type="range" id="fxDelay" min="0" max="100" value="0"></div>
                        <div class="fx-row"><span>GRN</span><input type="range" id="fxGrain" min="0" max="100" value="0"></div>
                        <div class="fx-row"><span>GLI</span><input type="range" id="fxGlitch" min="0" max="100" value="0"></div>
                        <div class="fx-row"><span>CRU</span><input type="range" id="fxCrush" min="1" max="16" value="16"></div>
                    </div>
                    <div class="punch-fx">
                        <button class="punch-btn" data-fx="stutter">STT</button>
                        <button class="punch-btn" data-fx="reverse">REV</button>
                        <button class="punch-btn" data-fx="filter">FLT</button>
                        <button class="punch-btn" data-fx="tape">TPE</button>
                    </div>
                </div>

                <!-- Recordings -->
                <div class="panel rec-panel">
                    <div class="rec-row">
                        <span class="panel-title">REC</span>
                        <span id="recCount">0</span>
                        <button id="recListBtn" class="rec-list-btn">LIST</button>
                    </div>
                    <div class="rec-list" id="recList"></div>
                </div>
            </section>

            <!-- PADS - spans bottom of columns 2-4 -->
            <section class="pads-section">
                <div class="panel pads-panel">
                    <div class="pads-header">
                        <span class="panel-title">PADS</span>
                        <select id="sampleBank">
                            <option value="kit1">Kit1</option>
                            <option value="kit2">Kit2</option>
                            <option value="kit3">Kit3</option>
                        </select>
                    </div>
                    <div class="pads-grid">
                        <button class="pad" data-pad="0">1</button>
                        <button class="pad" data-pad="1">2</button>
                        <button class="pad" data-pad="2">3</button>
                        <button class="pad" data-pad="3">4</button>
                        <button class="pad" data-pad="4">5</button>
                        <button class="pad" data-pad="5">6</button>
                        <button class="pad" data-pad="6">7</button>
                        <button class="pad" data-pad="7">8</button>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- Admin Settings Modal -->
    <div id="adminModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">SETTINGS</span>
                <button id="closeAdmin" class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <div class="settings-title">SAMPLE KITS</div>
                    <div class="kit-list" id="kitList">
                        <div class="kit-item active" data-kit="kit1">Kit 1 (Default)</div>
                        <div class="kit-item" data-kit="kit2">Kit 2 (Electronic)</div>
                        <div class="kit-item" data-kit="kit3">Kit 3 (Acoustic)</div>
                    </div>
                    <input type="file" id="uploadKit" accept="audio/*" multiple hidden>
                    <button id="uploadKitBtn" class="settings-btn">Upload Kit</button>
                </div>
                <div class="settings-section">
                    <div class="settings-title">SYNTH PRESETS</div>
                    <div class="synth-presets" id="synthPresets">
                        <div class="preset-item active" data-preset="default">Default</div>
                        <div class="preset-item" data-preset="bass">Bass</div>
                        <div class="preset-item" data-preset="lead">Lead</div>
                        <div class="preset-item" data-preset="pad">Pad</div>
                    </div>
                </div>
                <div class="settings-section">
                    <div class="settings-title">THEME</div>
                    <div class="theme-options">
                        <button class="theme-btn active" data-theme="mariani">Vin Mariani</button>
                        <button class="theme-btn" data-theme="map">Location Map</button>
                        <button class="theme-btn" data-theme="dark">Dark</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/gps.js"></script>
    <script src="js/audio-engine.js"></script>
    <script src="js/mic-input.js"></script>
    <script src="js/sampler.js"></script>
    <script src="js/synth.js"></script>
    <script src="js/radio.js"></script>
    <script src="js/recorder.js"></script>
    <script src="js/sequencer.js"></script>
    <script src="js/mangle.js"></script>
    <script src="js/scenes.js"></script>
    <script src="js/arrangement.js"></script>
    <script src="js/ai-composer.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
