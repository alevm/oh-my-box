<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Oh My Box</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app">
        <!-- Location Image Banner -->
        <div class="location-banner" id="locationBanner">
            <div class="location-image" id="locationImage">
                <div class="location-placeholder">
                    <span class="location-icon">üåç</span>
                    <span class="location-text">Acquiring location...</span>
                </div>
            </div>
            <div class="location-overlay">
                <span class="location-coords" id="locationCoords">--</span>
            </div>
        </div>

        <!-- Header with Mode Toggle -->
        <header class="header">
            <div class="header-left">
                <h1>Oh My Box</h1>
                <div class="mode-toggle">
                    <button class="mode-btn active" data-mode="orchestrate">ORCH</button>
                    <button class="mode-btn" data-mode="perform">PERF</button>
                </div>
            </div>
            <div class="gps-status" id="gpsStatus">
                <span class="gps-icon">üìç</span>
                <span id="gpsCoords">GPS: waiting...</span>
            </div>
        </header>

        <!-- Main Transport -->
        <div class="transport">
            <button id="btnPlay" class="transport-btn play-btn">
                <span class="btn-icon">‚ñ∂</span>
                <span class="btn-label">PLAY</span>
            </button>
            <button id="btnStop" class="transport-btn stop-btn">
                <span class="btn-icon">‚èπ</span>
                <span class="btn-label">STOP</span>
            </button>
            <button id="btnRecord" class="transport-btn record-btn">
                <span class="btn-icon">‚è∫</span>
                <span class="btn-label">REC</span>
            </button>
            <div class="tempo-display">
                <span id="tempoValue">120</span>
                <span class="tempo-label">BPM</span>
            </div>
            <div class="time-display" id="timeDisplay">00:00</div>
        </div>

        <!-- SCREEN AREA -->
        <div class="screen-area">

            <!-- ========== ORCH MODE: Single scrollable page ========== -->
            <div id="orchView" class="orch-view">

                <!-- Scene Bar (sticky at top) -->
                <div class="orch-scene-bar">
                    <span class="scene-label">SCENE</span>
                    <button class="scene-btn active" data-scene="0">A</button>
                    <button class="scene-btn" data-scene="1">B</button>
                    <button class="scene-btn" data-scene="2">C</button>
                    <button class="scene-btn" data-scene="3">D</button>
                    <button class="scene-save-btn" id="saveScene">SAVE</button>
                </div>

                <!-- Scrollable content -->
                <div class="orch-scroll">

                    <!-- SECTION: Mixer -->
                    <section class="orch-section">
                        <div class="section-header">
                            <span class="section-icon">üéö</span>
                            <span class="section-title">MIXER</span>
                        </div>
                        <div class="mixer-compact">
                            <div class="mix-channel">
                                <span class="ch-label">MIC</span>
                                <input type="range" class="h-fader" id="faderMic" min="0" max="100" value="80">
                                <button class="mute-btn" id="muteMic">M</button>
                            </div>
                            <div class="mix-channel">
                                <span class="ch-label">SAMP</span>
                                <input type="range" class="h-fader" id="faderSamples" min="0" max="100" value="80">
                                <button class="mute-btn" id="muteSamples">M</button>
                            </div>
                            <div class="mix-channel">
                                <span class="ch-label">SYNTH</span>
                                <input type="range" class="h-fader" id="faderSynth" min="0" max="100" value="80">
                                <button class="mute-btn" id="muteSynth">M</button>
                            </div>
                            <div class="mix-channel">
                                <span class="ch-label">RADIO</span>
                                <input type="range" class="h-fader" id="faderRadio" min="0" max="100" value="80">
                                <button class="mute-btn" id="muteRadio">M</button>
                            </div>
                            <div class="mix-channel master">
                                <span class="ch-label">MAIN</span>
                                <input type="range" class="h-fader" id="faderMaster" min="0" max="100" value="90">
                            </div>
                        </div>
                    </section>

                    <!-- SECTION: Sequencer -->
                    <section class="orch-section">
                        <div class="section-header">
                            <span class="section-icon">‚ñ¶</span>
                            <span class="section-title">SEQUENCER</span>
                            <div class="seq-tempo-inline">
                                <input type="range" id="seqTempo" min="60" max="200" value="120">
                                <span id="seqTempoDisplay">120</span>
                            </div>
                        </div>

                        <!-- Track selector row -->
                        <div class="seq-track-row">
                            <select id="seqTrack">
                                <option value="0">1</option>
                                <option value="1">2</option>
                                <option value="2">3</option>
                                <option value="3">4</option>
                                <option value="4">5</option>
                                <option value="5">6</option>
                                <option value="6">7</option>
                                <option value="7">8</option>
                            </select>
                            <select id="seqSource">
                                <option value="sampler">Sampler</option>
                                <option value="synth">Synth</option>
                                <option value="radio">Radio</option>
                                <option value="mic">Mic</option>
                            </select>
                            <button id="seqRandom" class="seq-action-btn">RND</button>
                            <button id="seqClear" class="seq-action-btn">CLR</button>
                        </div>

                        <!-- 16-step grid -->
                        <div class="seq-grid" id="seqGrid">
                            <!-- Steps generated by JS -->
                        </div>

                        <!-- Track overview (8 rows compact) -->
                        <div class="seq-overview-compact" id="seqOverview">
                            <!-- Generated by JS -->
                        </div>

                        <!-- Euclidean generator -->
                        <div class="euclidean-row">
                            <span class="euc-label">EUCLID</span>
                            <label>H<input type="number" id="eucHits" min="1" max="16" value="4"></label>
                            <label>S<input type="number" id="eucSteps" min="1" max="16" value="16"></label>
                            <label>R<input type="number" id="eucRotate" min="0" max="15" value="0"></label>
                            <button id="eucGenerate" class="euc-btn">GEN</button>
                        </div>
                    </section>

                    <!-- SECTION: Pads -->
                    <section class="orch-section">
                        <div class="section-header">
                            <span class="section-icon">‚¨õ</span>
                            <span class="section-title">PADS</span>
                            <select id="sampleBank" class="inline-select">
                                <option value="kit1">Kit 1</option>
                                <option value="kit2">Kit 2</option>
                                <option value="kit3">Kit 3</option>
                            </select>
                        </div>
                        <div class="pads-row">
                            <button class="pad" data-pad="0">1</button>
                            <button class="pad" data-pad="1">2</button>
                            <button class="pad" data-pad="2">3</button>
                            <button class="pad" data-pad="3">4</button>
                            <button class="pad" data-pad="4">5</button>
                            <button class="pad" data-pad="5">6</button>
                            <button class="pad" data-pad="6">7</button>
                            <button class="pad" data-pad="7">8</button>
                        </div>
                    </section>

                    <!-- SECTION: Synth -->
                    <section class="orch-section">
                        <div class="section-header">
                            <span class="section-icon">‚àø</span>
                            <span class="section-title">SYNTH</span>
                            <button id="synthToggle" class="synth-power-btn">OFF</button>
                        </div>
                        <div class="synth-row">
                            <div class="synth-knob-group">
                                <span class="knob-label">FREQ</span>
                                <input type="range" id="synthFreq" min="20" max="2000" value="220">
                                <span class="knob-value" id="freqDisplay">220</span>
                            </div>
                            <div class="synth-knob-group">
                                <span class="knob-label">FILTER</span>
                                <input type="range" id="orchFilterCutoff" min="20" max="8000" value="4000">
                                <span class="knob-value" id="orchFilterDisplay">4k</span>
                            </div>
                            <div class="synth-knob-group">
                                <span class="knob-label">RES</span>
                                <input type="range" id="orchFilterRes" min="0" max="25" value="1">
                                <span class="knob-value" id="orchResDisplay">1</span>
                            </div>
                        </div>
                        <div class="wave-row">
                            <button class="wave-btn active" data-wave="sine">SIN</button>
                            <button class="wave-btn" data-wave="triangle">TRI</button>
                            <button class="wave-btn" data-wave="sawtooth">SAW</button>
                            <button class="wave-btn" data-wave="square">SQR</button>
                        </div>
                        <div class="mini-keyboard">
                            <button class="key white" data-note="0">C</button>
                            <button class="key black" data-note="1"></button>
                            <button class="key white" data-note="2">D</button>
                            <button class="key black" data-note="3"></button>
                            <button class="key white" data-note="4">E</button>
                            <button class="key white" data-note="5">F</button>
                            <button class="key black" data-note="6"></button>
                            <button class="key white" data-note="7">G</button>
                            <button class="key black" data-note="8"></button>
                            <button class="key white" data-note="9">A</button>
                            <button class="key black" data-note="10"></button>
                            <button class="key white" data-note="11">B</button>
                            <button class="key white" data-note="12">C</button>
                        </div>
                    </section>

                    <!-- SECTION: FX -->
                    <section class="orch-section">
                        <div class="section-header">
                            <span class="section-icon">‚óà</span>
                            <span class="section-title">FX</span>
                            <div class="fx-route-btns">
                                <button class="route-btn active" data-route="master">M</button>
                                <button class="route-btn" data-route="mic">MIC</button>
                                <button class="route-btn" data-route="samples">SMP</button>
                                <button class="route-btn" data-route="synth">SYN</button>
                                <button class="route-btn" data-route="radio">RAD</button>
                            </div>
                        </div>
                        <div class="fx-grid">
                            <div class="fx-item">
                                <span class="fx-name">DELAY</span>
                                <input type="range" id="delayMix" min="0" max="100" value="0">
                                <span class="fx-val" id="delayMixDisplay">0</span>
                            </div>
                            <div class="fx-item">
                                <span class="fx-name">CRUSH</span>
                                <input type="range" id="crushBits" min="1" max="16" value="16">
                                <span class="fx-val" id="crushBitsDisplay">16</span>
                            </div>
                            <div class="fx-item">
                                <span class="fx-name">GLITCH</span>
                                <input type="range" id="glitchProb" min="0" max="100" value="0">
                                <span class="fx-val" id="glitchProbDisplay">0</span>
                            </div>
                            <div class="fx-item">
                                <span class="fx-name">GRAIN</span>
                                <input type="range" id="grainDensity" min="0" max="100" value="0">
                                <span class="fx-val" id="grainDensityDisplay">0</span>
                            </div>
                        </div>
                    </section>

                    <!-- SECTION: Radio -->
                    <section class="orch-section">
                        <div class="section-header">
                            <span class="section-icon">üìª</span>
                            <span class="section-title">RADIO</span>
                            <span class="radio-now" id="currentStation">--</span>
                        </div>
                        <div class="radio-row">
                            <input type="text" id="radioSearch" placeholder="Search...">
                            <button id="radioSearchBtn">GO</button>
                            <button id="radioStop" class="radio-stop-btn" disabled>STOP</button>
                        </div>
                        <div class="station-list-compact" id="stationList">
                            <span class="placeholder">Search for stations</span>
                        </div>
                    </section>

                    <!-- SECTION: AI Generator -->
                    <section class="orch-section">
                        <div class="section-header">
                            <span class="section-icon">ü§ñ</span>
                            <span class="section-title">AI GENERATE</span>
                        </div>
                        <div class="ai-row">
                            <div class="vibe-btns">
                                <button class="vibe-btn active" data-vibe="calm">CALM</button>
                                <button class="vibe-btn" data-vibe="urban">URBAN</button>
                                <button class="vibe-btn" data-vibe="nature">NATURE</button>
                                <button class="vibe-btn" data-vibe="chaos">CHAOS</button>
                            </div>
                        </div>
                        <div class="ai-controls-row">
                            <div class="ai-slider">
                                <span>Density</span>
                                <input type="range" id="aiDensity" min="10" max="100" value="50">
                            </div>
                            <div class="ai-slider">
                                <span>Complexity</span>
                                <input type="range" id="aiComplexity" min="10" max="100" value="50">
                            </div>
                        </div>
                        <div class="ai-buttons">
                            <button id="aiGenerate" class="ai-btn">GENERATE</button>
                            <button id="aiSurprise" class="ai-btn">SURPRISE</button>
                        </div>
                    </section>

                    <!-- SECTION: Files -->
                    <section class="orch-section">
                        <div class="section-header">
                            <span class="section-icon">üìÅ</span>
                            <span class="section-title">RECORDINGS</span>
                        </div>
                        <div class="recordings-list-compact" id="recordingsList">
                            <span class="placeholder">No recordings yet</span>
                        </div>
                    </section>

                </div><!-- end orch-scroll -->
            </div><!-- end orchView -->

            <!-- ========== PERF MODE: Generative player ========== -->
            <div id="performView" class="perform-view hidden">

                <!-- Large visual feedback area -->
                <div class="perf-visual">
                    <div class="perf-scene-display">
                        <span class="big-scene" id="perfSceneLetter">A</span>
                    </div>
                    <div class="perf-step-ring" id="perfStepRing">
                        <!-- 16 dots in a circle generated by JS -->
                    </div>
                    <div class="perf-info">
                        <span class="perf-bpm" id="perfBpm">120 BPM</span>
                        <span class="perf-status" id="perfStatus">READY</span>
                    </div>
                </div>

                <!-- Scene quick switch -->
                <div class="perf-scene-switch">
                    <button class="perf-scene-btn active" data-scene="0">A</button>
                    <button class="perf-scene-btn" data-scene="1">B</button>
                    <button class="perf-scene-btn" data-scene="2">C</button>
                    <button class="perf-scene-btn" data-scene="3">D</button>
                </div>

                <!-- Live modulation controls -->
                <div class="perf-live-controls">
                    <div class="live-param">
                        <span class="param-name">FILTER</span>
                        <input type="range" id="perfFilter" min="20" max="8000" value="4000" class="big-slider">
                    </div>
                    <div class="live-param">
                        <span class="param-name">FX MIX</span>
                        <input type="range" id="perfFxMix" min="0" max="100" value="0" class="big-slider">
                    </div>
                </div>

                <!-- Mic reactivity indicator -->
                <div class="perf-mic-indicator">
                    <span class="mic-label">MIC LEVEL</span>
                    <div class="mic-meter" id="perfMicMeter">
                        <div class="mic-meter-fill" id="perfMicFill"></div>
                    </div>
                    <div class="mic-reactive-toggle">
                        <span>MIC ‚Üí SYNTH</span>
                        <button id="micReactiveToggle" class="toggle-btn">OFF</button>
                    </div>
                </div>

            </div><!-- end performView -->

        </div><!-- end screen-area -->

        <!-- Version badge -->
        <div class="version-badge">v0.4.2</div>
    </div>

    <script src="js/gps.js"></script>
    <script src="js/audio-engine.js"></script>
    <script src="js/mic-input.js"></script>
    <script src="js/sampler.js"></script>
    <script src="js/synth.js"></script>
    <script src="js/radio.js"></script>
    <script src="js/recorder.js"></script>
    <script src="js/sequencer.js"></script>
    <script src="js/mangle.js"></script>
    <script src="js/scenes.js"></script>
    <script src="js/arrangement.js"></script>
    <script src="js/ai-composer.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
