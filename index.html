<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Oh My Box</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app">
        <!-- Location Image Banner -->
        <div class="location-banner" id="locationBanner">
            <div class="location-image" id="locationImage">
                <div class="location-placeholder">
                    <span class="location-icon">üåç</span>
                    <span class="location-text">Acquiring location...</span>
                </div>
            </div>
            <div class="location-overlay">
                <span class="location-coords" id="locationCoords">--</span>
            </div>
        </div>

        <!-- Header with Mode Toggle -->
        <header class="header">
            <div class="header-left">
                <h1>Oh My Box</h1>
                <div class="mode-toggle">
                    <button class="mode-btn active" data-mode="orchestrate">ORCH</button>
                    <button class="mode-btn" data-mode="perform">PERF</button>
                </div>
            </div>
            <div class="gps-status" id="gpsStatus">
                <span class="gps-icon">üìç</span>
                <span id="gpsCoords">GPS: waiting...</span>
            </div>
        </header>

        <!-- Main Transport -->
        <div class="transport">
            <button id="btnPlay" class="transport-btn play-btn">
                <span class="btn-icon">‚ñ∂</span>
                <span class="btn-label">PLAY</span>
            </button>
            <button id="btnStop" class="transport-btn stop-btn">
                <span class="btn-icon">‚èπ</span>
                <span class="btn-label">STOP</span>
            </button>
            <button id="btnRecord" class="transport-btn record-btn">
                <span class="btn-icon">‚è∫</span>
                <span class="btn-label">REC</span>
            </button>
            <div class="tempo-display">
                <span id="tempoValue">120</span>
                <span class="tempo-label">BPM</span>
            </div>
            <div class="time-display" id="timeDisplay">00:00</div>
        </div>

        <!-- SCREEN AREA - Contains swappable content (ORCH tabs or PERF view) -->
        <div class="screen-area">
            <!-- Tab Navigation (ORCH mode) -->
            <nav class="tabs">
                <button class="tab active" data-tab="mixer">Mix</button>
                <button class="tab" data-tab="seq">Seq</button>
                <button class="tab" data-tab="pads">Pads</button>
                <button class="tab" data-tab="synth">Synth</button>
                <button class="tab" data-tab="fx">FX</button>
                <button class="tab" data-tab="ai">AI</button>
                <button class="tab" data-tab="radio">Radio</button>
                <button class="tab" data-tab="recordings">Files</button>
            </nav>

            <!-- Tab Content (ORCH mode) -->
            <main class="content">
            <!-- Mixer Tab -->
            <section id="tab-mixer" class="tab-content active">
                <div class="scene-bar">
                    <span class="scene-label">Scene:</span>
                    <button class="scene-btn active" data-scene="0">A</button>
                    <button class="scene-btn" data-scene="1">B</button>
                    <button class="scene-btn" data-scene="2">C</button>
                    <button class="scene-btn" data-scene="3">D</button>
                    <div class="scene-save-group">
                        <span class="save-label">Save to:</span>
                        <button class="scene-save-slot" data-scene="0">A</button>
                        <button class="scene-save-slot" data-scene="1">B</button>
                        <button class="scene-save-slot" data-scene="2">C</button>
                        <button class="scene-save-slot" data-scene="3">D</button>
                    </div>
                </div>

                <!-- Arrangement (Scene Sequencing) -->
                <div class="arrangement-section">
                    <div class="arrangement-header">
                        <span class="arr-label">Arrangement:</span>
                        <span class="arr-position" id="arrangementPosition">0 blocks</span>
                        <div class="arr-controls">
                            <button class="arr-play" id="arrPlay">Play</button>
                            <button class="arr-stop" id="arrStop">Stop</button>
                            <button class="arr-clear" id="arrClear">Clear</button>
                        </div>
                    </div>
                    <div class="arrangement-blocks" id="arrangementBlocks">
                        <div class="arr-empty">Add scenes to build arrangement</div>
                    </div>
                    <div class="arrangement-add">
                        <span class="arr-add-label">Add:</span>
                        <button class="arr-add-btn" data-scene="0">+A</button>
                        <button class="arr-add-btn" data-scene="1">+B</button>
                        <button class="arr-add-btn" data-scene="2">+C</button>
                        <button class="arr-add-btn" data-scene="3">+D</button>
                        <label class="arr-bars-label">
                            Bars:
                            <input type="number" id="arrBars" min="1" max="32" value="4">
                        </label>
                    </div>
                </div>

                <div class="mixer">
                    <div class="channel" data-channel="mic">
                        <div class="channel-label">MIC</div>
                        <div class="meter" id="meterMic"><div class="meter-fill"></div></div>
                        <input type="range" class="fader" id="faderMic" min="0" max="100" value="80" orient="vertical">
                        <button class="mute-btn" id="muteMic">M</button>
                    </div>
                    <div class="channel" data-channel="samples">
                        <div class="channel-label">SAMP</div>
                        <div class="meter" id="meterSamples"><div class="meter-fill"></div></div>
                        <input type="range" class="fader" id="faderSamples" min="0" max="100" value="80" orient="vertical">
                        <button class="mute-btn" id="muteSamples">M</button>
                    </div>
                    <div class="channel" data-channel="synth">
                        <div class="channel-label">SYNTH</div>
                        <div class="meter" id="meterSynth"><div class="meter-fill"></div></div>
                        <input type="range" class="fader" id="faderSynth" min="0" max="100" value="80" orient="vertical">
                        <button class="mute-btn" id="muteSynth">M</button>
                    </div>
                    <div class="channel" data-channel="radio">
                        <div class="channel-label">RADIO</div>
                        <div class="meter" id="meterRadio"><div class="meter-fill"></div></div>
                        <input type="range" class="fader" id="faderRadio" min="0" max="100" value="80" orient="vertical">
                        <button class="mute-btn" id="muteRadio">M</button>
                    </div>
                    <div class="channel master" data-channel="master">
                        <div class="channel-label">MAIN</div>
                        <div class="meter" id="meterMaster"><div class="meter-fill"></div></div>
                        <input type="range" class="fader" id="faderMaster" min="0" max="100" value="90" orient="vertical">
                    </div>
                </div>
            </section>

            <!-- Sequencer Tab -->
            <section id="tab-seq" class="tab-content">
                <div class="seq-controls">
                    <div class="seq-track-select">
                        <label>Track:</label>
                        <select id="seqTrack">
                            <option value="0">1 - Kick</option>
                            <option value="1">2 - Snare</option>
                            <option value="2">3 - HiHat</option>
                            <option value="3">4 - Clap</option>
                            <option value="4">5 - Tom</option>
                            <option value="5">6 - Rim</option>
                            <option value="6">7 - Shaker</option>
                            <option value="7">8 - Cowbell</option>
                        </select>
                    </div>
                    <div class="seq-source-select">
                        <label>Source:</label>
                        <select id="seqSource">
                            <option value="sampler">Sampler</option>
                            <option value="radio">Radio</option>
                            <option value="mic">Mic</option>
                            <option value="synth">Synth</option>
                        </select>
                    </div>
                    <div class="seq-tempo">
                        <label>Tempo:</label>
                        <input type="range" id="seqTempo" min="60" max="200" value="120">
                        <span id="seqTempoDisplay">120</span>
                    </div>
                </div>

                <!-- Source routing overview -->
                <div class="source-routing" id="sourceRouting">
                    <div class="routing-row"><span class="routing-num">1</span><span class="routing-source" data-track="0">Sampler</span></div>
                    <div class="routing-row"><span class="routing-num">2</span><span class="routing-source" data-track="1">Sampler</span></div>
                    <div class="routing-row"><span class="routing-num">3</span><span class="routing-source" data-track="2">Sampler</span></div>
                    <div class="routing-row"><span class="routing-num">4</span><span class="routing-source" data-track="3">Sampler</span></div>
                    <div class="routing-row"><span class="routing-num">5</span><span class="routing-source" data-track="4">Sampler</span></div>
                    <div class="routing-row"><span class="routing-num">6</span><span class="routing-source" data-track="5">Sampler</span></div>
                    <div class="routing-row"><span class="routing-num">7</span><span class="routing-source" data-track="6">Sampler</span></div>
                    <div class="routing-row"><span class="routing-num">8</span><span class="routing-source" data-track="7">Sampler</span></div>
                </div>

                <!-- Step position indicator -->
                <div class="seq-position-bar">
                    <span class="seq-pos-label">Step:</span>
                    <span class="seq-pos-value" id="seqPosValue">--</span>
                    <span class="seq-pos-bar-wrap">
                        <span class="seq-pos-fill" id="seqPosFill"></span>
                    </span>
                </div>

                <!-- 16-step grid -->
                <div class="seq-grid" id="seqGrid">
                    <!-- Steps will be generated by JS -->
                </div>

                <!-- Track overview (8 rows) -->
                <div class="seq-overview" id="seqOverview">
                    <!-- Track rows will be generated by JS -->
                </div>

                <div class="seq-tools">
                    <div class="euclidean-gen">
                        <h4>Euclidean Generator</h4>
                        <div class="euclidean-controls">
                            <label>
                                <span>Hits:</span>
                                <input type="number" id="eucHits" min="1" max="16" value="4">
                            </label>
                            <label>
                                <span>Steps:</span>
                                <input type="number" id="eucSteps" min="1" max="16" value="16">
                            </label>
                            <label>
                                <span>Rotate:</span>
                                <input type="number" id="eucRotate" min="0" max="15" value="0">
                            </label>
                            <button id="eucGenerate" class="gen-btn">Generate</button>
                        </div>
                    </div>
                    <div class="probability-control">
                        <label>
                            <span>Probability:</span>
                            <input type="range" id="seqProb" min="0" max="100" value="100">
                            <span id="seqProbDisplay">100%</span>
                        </label>
                    </div>
                    <div class="seq-actions">
                        <button id="seqClear">Clear Track</button>
                        <button id="seqRandom">Random</button>
                    </div>
                </div>
            </section>

            <!-- Pads Tab -->
            <section id="tab-pads" class="tab-content">
                <div class="pad-grid">
                    <button class="pad" data-pad="0">1</button>
                    <button class="pad" data-pad="1">2</button>
                    <button class="pad" data-pad="2">3</button>
                    <button class="pad" data-pad="3">4</button>
                    <button class="pad" data-pad="4">5</button>
                    <button class="pad" data-pad="5">6</button>
                    <button class="pad" data-pad="6">7</button>
                    <button class="pad" data-pad="7">8</button>
                </div>
                <div class="pad-controls">
                    <label>
                        <span>Sample Bank:</span>
                        <select id="sampleBank">
                            <option value="kit1">Kit 1 - Percussion</option>
                            <option value="kit2">Kit 2 - Textures</option>
                            <option value="kit3">Kit 3 - Tones</option>
                        </select>
                    </label>
                </div>
            </section>

            <!-- Synth Tab - Eurorack Style -->
            <section id="tab-synth" class="tab-content">
                <div class="eurorack-synth">
                    <!-- Module 1: VCO (Voltage Controlled Oscillator) -->
                    <div class="euro-module vco-module">
                        <div class="module-header">
                            <span class="module-name">VCO</span>
                            <button id="synthToggle" class="module-power">
                                <span class="led off"></span>
                            </button>
                        </div>
                        <div class="module-controls">
                            <div class="euro-knob-group">
                                <div class="euro-knob" data-param="freq">
                                    <input type="range" id="synthFreq" min="20" max="2000" value="220">
                                    <div class="knob-indicator"></div>
                                </div>
                                <span class="knob-label">FREQ</span>
                                <span class="knob-value" id="freqDisplay">220</span>
                            </div>
                            <div class="euro-knob-group">
                                <div class="euro-knob" data-param="detune">
                                    <input type="range" id="synthDetune" min="-100" max="100" value="0">
                                    <div class="knob-indicator"></div>
                                </div>
                                <span class="knob-label">DETUNE</span>
                                <span class="knob-value" id="detuneDisplay">0</span>
                            </div>
                        </div>
                        <div class="wave-selector">
                            <button class="wave-select-btn active" data-wave="sine" title="Sine">
                                <svg viewBox="0 0 24 12"><path d="M0,6 Q6,0 12,6 Q18,12 24,6" stroke="currentColor" fill="none" stroke-width="2"/></svg>
                            </button>
                            <button class="wave-select-btn" data-wave="triangle" title="Triangle">
                                <svg viewBox="0 0 24 12"><path d="M0,6 L6,0 L12,6 L18,12 L24,6" stroke="currentColor" fill="none" stroke-width="2"/></svg>
                            </button>
                            <button class="wave-select-btn" data-wave="sawtooth" title="Sawtooth">
                                <svg viewBox="0 0 24 12"><path d="M0,12 L12,0 L12,12 L24,0" stroke="currentColor" fill="none" stroke-width="2"/></svg>
                            </button>
                            <button class="wave-select-btn" data-wave="square" title="Square">
                                <svg viewBox="0 0 24 12"><path d="M0,12 L0,0 L12,0 L12,12 L24,12 L24,0" stroke="currentColor" fill="none" stroke-width="2"/></svg>
                            </button>
                        </div>
                        <input type="hidden" id="synthWaveform" value="sine">
                    </div>

                    <!-- Module 2: VCF (Voltage Controlled Filter) -->
                    <div class="euro-module vcf-module">
                        <div class="module-header">
                            <span class="module-name">VCF</span>
                            <span class="module-type">LP</span>
                        </div>
                        <div class="module-controls">
                            <div class="euro-knob-group">
                                <div class="euro-knob large" data-param="cutoff">
                                    <input type="range" id="orchFilterCutoff" min="20" max="8000" value="4000">
                                    <div class="knob-indicator"></div>
                                </div>
                                <span class="knob-label">CUTOFF</span>
                                <span class="knob-value" id="orchFilterDisplay">4k</span>
                            </div>
                            <div class="euro-knob-group">
                                <div class="euro-knob" data-param="res">
                                    <input type="range" id="orchFilterRes" min="0" max="25" value="1">
                                    <div class="knob-indicator"></div>
                                </div>
                                <span class="knob-label">RES</span>
                                <span class="knob-value" id="orchResDisplay">1</span>
                            </div>
                        </div>
                    </div>

                    <!-- Module 3: Noise Generator -->
                    <div class="euro-module noise-module">
                        <div class="module-header">
                            <span class="module-name">NOISE</span>
                        </div>
                        <div class="module-controls">
                            <div class="euro-knob-group">
                                <div class="euro-knob" data-param="noise">
                                    <input type="range" id="orchNoise" min="0" max="100" value="0">
                                    <div class="knob-indicator"></div>
                                </div>
                                <span class="knob-label">LEVEL</span>
                                <span class="knob-value" id="orchNoiseDisplay">0%</span>
                            </div>
                        </div>
                        <div class="noise-type-selector">
                            <button class="noise-type-btn active" data-type="white">WHITE</button>
                            <button class="noise-type-btn" data-type="pink">PINK</button>
                        </div>
                    </div>

                    <!-- Module 4: Output / VCA -->
                    <div class="euro-module vca-module">
                        <div class="module-header">
                            <span class="module-name">OUT</span>
                        </div>
                        <div class="module-controls">
                            <div class="euro-knob-group">
                                <div class="euro-knob large" data-param="volume">
                                    <input type="range" id="synthVolume" min="0" max="100" value="70">
                                    <div class="knob-indicator"></div>
                                </div>
                                <span class="knob-label">LEVEL</span>
                                <span class="knob-value" id="synthVolumeDisplay">70%</span>
                            </div>
                        </div>
                        <div class="output-meter">
                            <div class="meter-bar" id="synthMeter"></div>
                        </div>
                    </div>
                </div>

                <!-- Keyboard Section -->
                <div class="euro-keyboard-section">
                    <div class="keyboard-header">
                        <span class="keyboard-title">KEYBOARD</span>
                        <div class="octave-controls">
                            <button class="octave-btn" id="octaveDown">-</button>
                            <span class="octave-display" id="octaveDisplay">4</span>
                            <button class="octave-btn" id="octaveUp">+</button>
                        </div>
                    </div>
                    <div class="euro-keyboard">
                        <button class="euro-key white" data-note="0">C</button>
                        <button class="euro-key black" data-note="1">C#</button>
                        <button class="euro-key white" data-note="2">D</button>
                        <button class="euro-key black" data-note="3">D#</button>
                        <button class="euro-key white" data-note="4">E</button>
                        <button class="euro-key white" data-note="5">F</button>
                        <button class="euro-key black" data-note="6">F#</button>
                        <button class="euro-key white" data-note="7">G</button>
                        <button class="euro-key black" data-note="8">G#</button>
                        <button class="euro-key white" data-note="9">A</button>
                        <button class="euro-key black" data-note="10">A#</button>
                        <button class="euro-key white" data-note="11">B</button>
                        <button class="euro-key white" data-note="12">C</button>
                    </div>
                </div>
            </section>

            <!-- FX/Mangle Tab -->
            <section id="tab-fx" class="tab-content">
                <!-- FX Routing Section -->
                <div class="fx-routing">
                    <span class="routing-label">APPLY FX TO:</span>
                    <div class="routing-buttons">
                        <button class="routing-btn active" data-route="master">MASTER</button>
                        <button class="routing-btn" data-route="mic">MIC</button>
                        <button class="routing-btn" data-route="samples">SAMP</button>
                        <button class="routing-btn" data-route="synth">SYNTH</button>
                        <button class="routing-btn" data-route="radio">RADIO</button>
                    </div>
                </div>

                <div class="fx-controls">
                    <div class="fx-section">
                        <h3>Bit Crusher</h3>
                        <label>
                            <span>Bits: <span id="crushBitsDisplay">16</span></span>
                            <input type="range" id="crushBits" min="1" max="16" value="16">
                        </label>
                        <label>
                            <span>Sample Rate: <span id="crushRateDisplay">44100</span></span>
                            <input type="range" id="crushRate" min="100" max="44100" value="44100">
                        </label>
                        <button id="crushToggle" class="fx-toggle">OFF</button>
                    </div>

                    <div class="fx-section">
                        <h3>Glitch</h3>
                        <label>
                            <span>Probability: <span id="glitchProbDisplay">0</span>%</span>
                            <input type="range" id="glitchProb" min="0" max="100" value="0">
                        </label>
                        <label>
                            <span>Slice Size: <span id="glitchSizeDisplay">100</span>ms</span>
                            <input type="range" id="glitchSize" min="10" max="500" value="100">
                        </label>
                        <div class="glitch-modes">
                            <button class="glitch-mode active" data-mode="stutter">Stutter</button>
                            <button class="glitch-mode" data-mode="reverse">Reverse</button>
                            <button class="glitch-mode" data-mode="jump">Jump</button>
                        </div>
                    </div>

                    <div class="fx-section">
                        <h3>Grain Cloud</h3>
                        <label>
                            <span>Density: <span id="grainDensityDisplay">0</span></span>
                            <input type="range" id="grainDensity" min="0" max="100" value="0">
                        </label>
                        <label>
                            <span>Size: <span id="grainSizeDisplay">50</span>ms</span>
                            <input type="range" id="grainSize" min="10" max="500" value="50">
                        </label>
                        <label>
                            <span>Pitch: <span id="grainPitchDisplay">0</span></span>
                            <input type="range" id="grainPitch" min="-12" max="12" value="0">
                        </label>
                        <button id="grainFreeze" class="fx-toggle">FREEZE</button>
                    </div>

                    <div class="fx-section">
                        <h3>Delay</h3>
                        <label>
                            <span>Time: <span id="delayTimeDisplay">250</span>ms</span>
                            <input type="range" id="delayTime" min="50" max="1000" value="250">
                        </label>
                        <label>
                            <span>Feedback: <span id="delayFeedbackDisplay">30</span>%</span>
                            <input type="range" id="delayFeedback" min="0" max="95" value="30">
                        </label>
                        <label>
                            <span>Mix: <span id="delayMixDisplay">0</span>%</span>
                            <input type="range" id="delayMix" min="0" max="100" value="0">
                        </label>
                    </div>
                </div>
            </section>

            <!-- AI Tab -->
            <section id="tab-ai" class="tab-content">
                <div class="ai-controls">
                    <div class="ai-context">
                        <h3>Context</h3>
                        <div class="context-info">
                            <div class="context-row">
                                <span class="context-label">Location:</span>
                                <span class="context-value" id="aiLocation">Unknown</span>
                            </div>
                            <div class="context-row">
                                <span class="context-label">Time:</span>
                                <span class="context-value" id="aiTime">--:--</span>
                            </div>
                            <div class="context-row">
                                <span class="context-label">Vibe:</span>
                                <span class="context-value" id="aiVibe">--</span>
                            </div>
                        </div>
                    </div>

                    <div class="ai-generate">
                        <h3>AI Rhythm Generator</h3>
                        <div class="vibe-selector">
                            <label>Vibe:</label>
                            <div class="vibe-buttons">
                                <button class="vibe-btn active" data-vibe="calm">Calm</button>
                                <button class="vibe-btn" data-vibe="urban">Urban</button>
                                <button class="vibe-btn" data-vibe="nature">Nature</button>
                                <button class="vibe-btn" data-vibe="chaos">Chaos</button>
                            </div>
                        </div>
                        <div class="density-control">
                            <label>
                                <span>Density: <span id="aiDensityDisplay">50</span>%</span>
                                <input type="range" id="aiDensity" min="10" max="100" value="50">
                            </label>
                        </div>
                        <div class="complexity-control">
                            <label>
                                <span>Complexity: <span id="aiComplexityDisplay">50</span>%</span>
                                <input type="range" id="aiComplexity" min="10" max="100" value="50">
                            </label>
                        </div>
                        <button id="aiGenerate" class="ai-generate-btn">Generate Rhythm</button>
                        <button id="aiSurprise" class="ai-surprise-btn">Surprise Me</button>
                        <button id="aiArrangement" class="ai-arrangement-btn">Build Full Arrangement</button>
                    </div>

                    <div class="ai-suggestions" id="aiSuggestions">
                        <h3>Suggestions</h3>
                        <div class="suggestion-list" id="suggestionList">
                            <p class="placeholder">Generate a rhythm to see AI suggestions</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Radio Tab -->
            <section id="tab-radio" class="tab-content">
                <div class="radio-controls">
                    <div class="radio-search">
                        <input type="text" id="radioSearch" placeholder="Search stations...">
                        <button id="radioSearchBtn">Search</button>
                    </div>
                    <div class="radio-filters">
                        <select id="radioCountry">
                            <option value="">All Countries</option>
                            <option value="ES">Spain</option>
                            <option value="FR">France</option>
                            <option value="DE">Germany</option>
                            <option value="GB">United Kingdom</option>
                            <option value="US">United States</option>
                            <option value="IT">Italy</option>
                        </select>
                        <select id="radioGenre">
                            <option value="">All Genres</option>
                            <option value="ambient">Ambient</option>
                            <option value="electronic">Electronic</option>
                            <option value="jazz">Jazz</option>
                            <option value="classical">Classical</option>
                            <option value="news">News</option>
                            <option value="local">Local</option>
                        </select>
                    </div>
                    <div class="station-list" id="stationList">
                        <p class="placeholder">Search for stations or select filters</p>
                    </div>
                    <div class="now-playing" id="nowPlaying">
                        <span class="np-label">Now Playing:</span>
                        <span class="np-station" id="currentStation">None</span>
                        <button id="radioStop" class="radio-stop-btn" disabled>Stop</button>
                    </div>
                </div>
            </section>

            <!-- Recordings Tab -->
            <section id="tab-recordings" class="tab-content">
                <div class="recordings-list" id="recordingsList">
                    <p class="placeholder">No recordings yet. Hit REC to start!</p>
                </div>
            </section>
            </main>

            <!-- PERFORM Mode View (inside screen-area, same as tabs/content) -->
            <div id="performView" class="perform-view hidden">
            <!-- Position Info Bar -->
            <div class="perf-position-bar">
                <div class="position-display">
                    <span class="scene-letter" id="perfScene">A</span>
                    <span class="position-sep">/</span>
                    <span class="step-number" id="perfStep">01</span>
                </div>
            </div>

            <!-- Step Sequencer Visual -->
            <div class="perf-sequencer">
                <div class="perf-steps" id="perfSteps">
                    <div class="perf-step-dot" data-step="0"></div>
                    <div class="perf-step-dot" data-step="1"></div>
                    <div class="perf-step-dot" data-step="2"></div>
                    <div class="perf-step-dot" data-step="3"></div>
                    <div class="perf-step-dot beat" data-step="4"></div>
                    <div class="perf-step-dot" data-step="5"></div>
                    <div class="perf-step-dot" data-step="6"></div>
                    <div class="perf-step-dot" data-step="7"></div>
                    <div class="perf-step-dot beat" data-step="8"></div>
                    <div class="perf-step-dot" data-step="9"></div>
                    <div class="perf-step-dot" data-step="10"></div>
                    <div class="perf-step-dot" data-step="11"></div>
                    <div class="perf-step-dot beat" data-step="12"></div>
                    <div class="perf-step-dot" data-step="13"></div>
                    <div class="perf-step-dot" data-step="14"></div>
                    <div class="perf-step-dot" data-step="15"></div>
                </div>
            </div>

            <!-- Scene Selection -->
            <div class="perf-scenes">
                <span class="scenes-label">SCENE</span>
                <div class="scenes-grid">
                    <button class="perf-scene-btn active" data-scene="0">A</button>
                    <button class="perf-scene-btn" data-scene="1">B</button>
                    <button class="perf-scene-btn" data-scene="2">C</button>
                    <button class="perf-scene-btn" data-scene="3">D</button>
                </div>
            </div>

            <!-- Main Controls Grid -->
            <div class="perf-main-grid">
                <!-- Left Column: Mixer -->
                <div class="perf-mixer-section">
                    <div class="section-title">MIXER</div>
                    <div class="perf-mixer">
                        <div class="perf-channel">
                            <div class="channel-meter" id="meterMic"></div>
                            <input type="range" class="channel-fader" id="perfFaderMic" min="0" max="100" value="80" orient="vertical">
                            <span class="channel-label">MIC</span>
                        </div>
                        <div class="perf-channel">
                            <div class="channel-meter" id="meterSamp"></div>
                            <input type="range" class="channel-fader" id="perfFaderSamples" min="0" max="100" value="80" orient="vertical">
                            <span class="channel-label">SAMP</span>
                        </div>
                        <div class="perf-channel">
                            <div class="channel-meter" id="meterSyn"></div>
                            <input type="range" class="channel-fader" id="perfFaderSynth" min="0" max="100" value="80" orient="vertical">
                            <span class="channel-label">SYN</span>
                        </div>
                        <div class="perf-channel">
                            <div class="channel-meter" id="meterRad"></div>
                            <input type="range" class="channel-fader" id="perfFaderRadio" min="0" max="100" value="80" orient="vertical">
                            <span class="channel-label">RAD</span>
                        </div>
                    </div>
                </div>

                <!-- Right Column: FX -->
                <div class="perf-fx-section">
                    <div class="section-title">FX</div>
                    <div class="perf-fx">
                        <div class="fx-knob-group">
                            <div class="fx-knob">
                                <input type="range" id="perfDelayMix" min="0" max="100" value="0">
                                <div class="knob-value" id="delayValue">0</div>
                            </div>
                            <span class="fx-label">DELAY</span>
                        </div>
                        <div class="fx-knob-group">
                            <div class="fx-knob">
                                <input type="range" id="perfGlitch" min="0" max="100" value="0">
                                <div class="knob-value" id="glitchValue">0</div>
                            </div>
                            <span class="fx-label">GLITCH</span>
                        </div>
                        <div class="fx-knob-group">
                            <div class="fx-knob">
                                <input type="range" id="perfCrush" min="1" max="16" value="16">
                                <div class="knob-value" id="crushValue">16</div>
                            </div>
                            <span class="fx-label">CRUSH</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sample Pads -->
            <div class="perf-pads-section">
                <div class="section-title">PADS</div>
                <div class="perf-pads">
                    <button class="perf-pad" data-pad="0">1</button>
                    <button class="perf-pad" data-pad="1">2</button>
                    <button class="perf-pad" data-pad="2">3</button>
                    <button class="perf-pad" data-pad="3">4</button>
                    <button class="perf-pad" data-pad="4">5</button>
                    <button class="perf-pad" data-pad="5">6</button>
                    <button class="perf-pad" data-pad="6">7</button>
                    <button class="perf-pad" data-pad="7">8</button>
                </div>
            </div>

            <!-- Synth Section -->
            <div class="perf-synth-section">
                <div class="synth-header">
                    <div class="section-title">SYNTH</div>
                    <button class="synth-power" id="perfSynthToggle">
                        <span class="power-indicator"></span>
                        <span class="power-text">OFF</span>
                    </button>
                </div>
                <div class="synth-controls">
                    <div class="synth-param">
                        <label>FREQ</label>
                        <input type="range" id="perfSynthFreq" min="50" max="1000" value="220">
                        <span class="param-value" id="perfFreqVal">220 Hz</span>
                    </div>
                    <div class="synth-param wave-select">
                        <label>WAVE</label>
                        <div class="wave-buttons">
                            <button class="wave-btn active" data-wave="sine" title="Sine">~</button>
                            <button class="wave-btn" data-wave="triangle" title="Triangle">/\</button>
                            <button class="wave-btn" data-wave="sawtooth" title="Sawtooth">/|</button>
                            <button class="wave-btn" data-wave="square" title="Square">[]</button>
                        </div>
                        <input type="hidden" id="perfSynthWave" value="sine">
                    </div>
                    <div class="synth-param">
                        <label>FILTER</label>
                        <input type="range" id="perfSynthFilter" min="100" max="5000" value="2000">
                        <span class="param-value" id="perfFilterVal">2k Hz</span>
                    </div>
                    <div class="synth-param">
                        <label>RES</label>
                        <input type="range" id="perfSynthRes" min="0" max="20" value="1">
                        <span class="param-value" id="perfResVal">1</span>
                    </div>
                </div>
                <div class="synth-keyboard">
                    <button class="synth-key white" data-note="261">C</button>
                    <button class="synth-key black" data-note="277">C#</button>
                    <button class="synth-key white" data-note="293">D</button>
                    <button class="synth-key black" data-note="311">D#</button>
                    <button class="synth-key white" data-note="329">E</button>
                    <button class="synth-key white" data-note="349">F</button>
                    <button class="synth-key black" data-note="369">F#</button>
                    <button class="synth-key white" data-note="392">G</button>
                    <button class="synth-key black" data-note="415">G#</button>
                    <button class="synth-key white" data-note="440">A</button>
                    <button class="synth-key black" data-note="466">A#</button>
                    <button class="synth-key white" data-note="493">B</button>
                </div>
            </div>
        </div>
        </div><!-- end screen-area -->

        <!-- Init Overlay (required for audio context) -->
        <div id="initOverlay" class="overlay">
            <div class="overlay-content">
                <h2>Oh My Box</h2>
                <p>ORCHESTRATE ‚Üí CAPTURE ‚Üí PERFORM</p>
                <button id="btnInit" class="init-btn">TAP TO START</button>
                <p class="small">Microphone & location access required</p>
                <div class="version-badge">v0.3.2</div>
            </div>
        </div>
    </div>

    <script src="js/gps.js"></script>
    <script src="js/audio-engine.js"></script>
    <script src="js/mic-input.js"></script>
    <script src="js/sampler.js"></script>
    <script src="js/synth.js"></script>
    <script src="js/radio.js"></script>
    <script src="js/recorder.js"></script>
    <script src="js/sequencer.js"></script>
    <script src="js/mangle.js"></script>
    <script src="js/scenes.js"></script>
    <script src="js/arrangement.js"></script>
    <script src="js/ai-composer.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
